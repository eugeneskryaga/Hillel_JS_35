{"version":3,"file":"index.js","sources":["../src/main.js"],"sourcesContent":["const api = axios.create({\n  baseURL: \"https://6971cf4a32c6bacb12c49096.mockapi.io\",\n});\n\nlet pageCounter = 1;\nlet search = \"\";\nlet sortOrder = \"asc\";\n\nconst root = document.querySelector(\"#root\");\n\nconst title = document.createElement(\"h1\");\n\nconst markup = document.createElement(\"div\");\nmarkup.style.display = \"flex\";\nmarkup.style.justifyContent = \"space-between\";\nroot.append(markup);\n\nconst border = \"2px solid black\";\nconst padding = \"20px\";\n\nconst bookListContainer = document.createElement(\"div\");\nbookListContainer.style.border = border;\nbookListContainer.style.padding = padding;\nmarkup.append(bookListContainer);\nbookListContainer.append(title);\n\nconst sortSelect = document.createElement(\"select\");\nsortSelect.style.marginBottom = \"5px\";\nsortSelect.innerHTML =\n  \"<option value='asc'>From A to Z</option><option value='desc'>From Z to A</option>\";\n\nconst searchForm = document.createElement(\"form\");\nsearchForm.innerHTML =\n  \"<input class='search' type=text name='search' style='margin-right: 5px'><button>Search</button>\";\n\nconst bookList = document.createElement(\"ul\");\nbookListContainer.append(bookList);\n\nbookList.before(searchForm);\nsearchForm.before(sortSelect);\n\nconst pageContainer = document.createElement(\"div\");\npageContainer.style.marginBottom = \"5px\";\nbookListContainer.append(pageContainer);\n\nconst addBookBtn = document.createElement(\"button\");\naddBookBtn.textContent = \"Add Book\";\nbookListContainer.append(addBookBtn);\n\nconst bookDescContainer = document.createElement(\"div\");\nbookDescContainer.style.maxWidth = \"50%\";\nmarkup.append(bookDescContainer);\n\nconst notification = document.createElement(\"div\");\n\nasync function showBookList() {\n  try {\n    bookList.innerHTML = \"\";\n    title.textContent = \"LOADING...\";\n\n    const { data } = await api(\"/books\", {\n      params: {\n        page: pageCounter,\n        limit: 5,\n        search,\n        sortBy: \"title\",\n        order: sortOrder,\n      },\n    });\n\n    data.forEach(book => {\n      const listItem = document.createElement(\"li\");\n      listItem.id = book.id;\n      listItem.style.marginBottom = \"10px\";\n\n      const bookTitle = book.title + \" \";\n\n      const detailsButton = document.createElement(\"button\");\n      detailsButton.textContent = \"View Details\";\n      detailsButton.style.marginRight = \"5px\";\n      detailsButton.addEventListener(\"click\", event => {\n        showDetails(event);\n      });\n\n      const deleteButton = document.createElement(\"button\");\n      deleteButton.textContent = \"Delete book\";\n      deleteButton.style.marginRight = \"5px\";\n      deleteButton.addEventListener(\"click\", event => deleteBook(event));\n\n      const editButton = document.createElement(\"button\");\n      editButton.textContent = \"Edit book\";\n      editButton.addEventListener(\"click\", event => editDescription(event));\n\n      listItem.append(bookTitle, detailsButton, deleteButton, editButton);\n      bookList.appendChild(listItem);\n    });\n\n    pageContainer.innerHTML = `\n    <button class=\"prev\">&lt;</button>\n    <strong> ${pageCounter} </strong>\n    <button class=\"next\">&gt;</button>`;\n\n    const prevButton = pageContainer.querySelector(\".prev\");\n    const nextButton = pageContainer.querySelector(\".next\");\n    prevButton.addEventListener(\"click\", handlePrevious);\n    nextButton.addEventListener(\"click\", handleNext);\n    if (pageCounter === 1) {\n      prevButton.style.display = \"none\";\n    }\n    if (data.length < 5) {\n      nextButton.style.display = \"none\";\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    title.textContent = \"Список книг\";\n  }\n}\n\nasync function showDetails(e) {\n  bookDescContainer.innerHTML = \"\";\n  bookDescContainer.style.border = border;\n  bookDescContainer.style.padding = padding;\n\n  const id = e.target.parentNode.id;\n  const button = e.target;\n  button.textContent = \"Loading...\";\n\n  try {\n    const { data } = await api(`/books/${id}`);\n    bookDescContainer.innerHTML = `\n        <h2>${data.title}</h2>\n        <p><strong>Автор:</strong> ${data.author}</p>\n        <p><strong>Рік видання:</strong> ${data.year}</p>\n        <p><strong>Опис:</strong> ${data.description}</p>\n      `;\n  } catch (error) {\n    console.log(error);\n  } finally {\n    button.textContent = \"View Details\";\n  }\n}\n\nasync function deleteBook(e) {\n  const id = e.target.parentNode.id;\n\n  try {\n    e.target.textContent = \"Deleteing...\";\n    await api.delete(`/books/${id}`);\n    showBookList();\n    showNotification();\n  } catch (error) {\n    console.log(error);\n  } finally {\n    e.target.textContent = \"Delete book\";\n  }\n}\n\nfunction showNotification() {\n  notification.innerHTML = \"\";\n  clearContainer(bookDescContainer);\n  setTimeout(() => {\n    notification.innerHTML = \"<strong>Книгу успішно видалено!</strong>\";\n    notification.style.width = \"25%\";\n    notification.style.textAlign = \"center\";\n    notification.style.padding = padding;\n    notification.style.border = border;\n    markup.append(notification);\n  }, 1000);\n  setTimeout(() => {\n    notification.remove();\n  }, 3000);\n}\n\nfunction createForm() {\n  const form = document.createElement(\"form\");\n  form.style.display = \"flex\";\n  form.style.flexDirection = \"column\";\n  form.style.gap = \"30px\";\n\n  form.innerHTML = `\n    <label>Title <input name=\"title\"></label>\n    <label>Author <input name=\"author\"></label>\n    <label>Year <input name=\"year\"></label>\n    <label>Description <textarea name=\"desc\" rows=\"5\" cols=\"40\"></textarea></label>\n    <button type=\"submit\">Submit</button>\n  `;\n\n  return form;\n}\n\nfunction validateData(book) {\n  if (\n    Object.values(book).some(value => value === null || value.trim() === \"\")\n  ) {\n    alert(\"Поля не мають бути пустими!\");\n    return false;\n  } else if (!Number.isInteger(Number(book.year))) {\n    alert(\"Рік має бути числом\");\n    return false;\n  } else {\n    return true;\n  }\n}\n\nfunction addDescription() {\n  bookDescContainer.innerHTML = \"\";\n\n  const title = document.createElement(\"h2\");\n  title.textContent = \"Додати книгу\";\n  bookDescContainer.prepend(title);\n\n  const form = createForm();\n\n  form.addEventListener(\"submit\", async e => {\n    e.preventDefault();\n\n    const data = new FormData(e.target);\n\n    const book = {\n      title: data.get(\"title\"),\n      author: data.get(\"author\"),\n      year: data.get(\"year\"),\n      description: data.get(\"desc\"),\n    };\n\n    if (validateData(book)) {\n      const submitButton = form.querySelector(\"button\");\n      submitButton.textContent = \"Submiting...\";\n\n      try {\n        await api.post(\"/books\", book);\n        showBookList();\n        clearContainer(bookDescContainer);\n      } catch (error) {\n        console.log(error);\n      } finally {\n        submitButton.textContent = \"Submit\";\n      }\n    }\n  });\n\n  bookDescContainer.append(form);\n}\n\nasync function editDescription(e) {\n  bookDescContainer.innerHTML = \"\";\n  bookDescContainer.style.border = border;\n  bookDescContainer.style.padding = padding;\n\n  const title = document.createElement(\"h2\");\n  title.textContent = \"Редагувати книгу\";\n  bookDescContainer.prepend(title);\n\n  const form = createForm();\n  const id = e.target.parentNode.id;\n\n  try {\n    const { data } = await api(`/books/${id}`);\n    form.elements.title.value = data.title;\n    form.elements.author.value = data.author;\n    form.elements.year.value = data.year;\n    form.elements.desc.value = data.description;\n  } catch (error) {\n    console.log(error);\n  }\n\n  form.addEventListener(\"submit\", async e => {\n    e.preventDefault();\n\n    const data = new FormData(e.target);\n\n    const book = {\n      title: data.get(\"title\"),\n      author: data.get(\"author\"),\n      year: data.get(\"year\"),\n      description: data.get(\"desc\"),\n    };\n\n    if (validateData(book)) {\n      const submitButton = form.querySelector(\"button\");\n      submitButton.textContent = \"Submiting...\";\n\n      try {\n        await api.put(`/books/${id}`, book);\n        showBookList();\n        clearContainer(bookDescContainer);\n      } catch (error) {\n        console.log(error);\n      } finally {\n        submitButton.textContent = \"Submit\";\n      }\n    }\n  });\n  bookDescContainer.append(form);\n}\n\nfunction handlePrevious() {\n  clearContainer(bookDescContainer);\n  pageCounter -= 1;\n  showBookList();\n}\n\nfunction handleNext() {\n  clearContainer(bookDescContainer);\n  pageCounter += 1;\n  showBookList();\n}\n\nfunction clearContainer(container) {\n  container.innerHTML = \"\";\n  container.style.border = \"none\";\n}\n\nfunction searchHandler(e) {\n  e.preventDefault();\n  search = e.target.elements.search.value.trim();\n  pageCounter = 1;\n  showBookList();\n  e.target.reset();\n  clearContainer(bookDescContainer);\n}\n\nfunction changeOrder(e) {\n  sortOrder = e.target.value;\n  pageCounter = 1;\n  showBookList();\n}\n\naddBookBtn.addEventListener(\"click\", addDescription);\nshowBookList();\n\nsearchForm.addEventListener(\"submit\", searchHandler);\n\nsortSelect.addEventListener(\"change\", changeOrder);\n"],"names":["api","pageCounter","search","sortOrder","root","title","markup","border","padding","bookListContainer","sortSelect","searchForm","bookList","pageContainer","addBookBtn","bookDescContainer","notification","showBookList","data","book","listItem","bookTitle","detailsButton","event","showDetails","deleteButton","deleteBook","editButton","editDescription","prevButton","nextButton","handlePrevious","handleNext","error","e","id","button","showNotification","clearContainer","createForm","form","validateData","value","addDescription","submitButton","container","searchHandler","changeOrder"],"mappings":"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"}